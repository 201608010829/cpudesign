# 实验日志

### 软件部分准备工作
#### 2019年7月1日-2019年7月2日
1、主要了解RISC精简指令集是什么，查找一些资料；  
2、对照MIPS指令集，分析两者差别。  
3、运行2018年模拟器版本，分析代码及指令格式。  
###### 参考网站：
RISC入门：https://blog.csdn.net/New_Horizon_/article/details/90314049  
RV32I指令集入门：https://www.cnblogs.com/mikewolf2002/p/9864652.html 

#### 2019年7月3日-2019年7月4日 
1、对应2018年模拟器版本c++代码，逐一分析指令，熟悉各指令的格式，并记录文档以备不时之需；  
2、与同学沟通分工并且请教老师对于代码的疑难点；  
3、对于立即数拼接更加熟练掌握  
4、了解或运算相当于拼接，与运算相当于取值 
###### 参考网站： 
RISC-V整数基本指令集： https://blog.csdn.net/zhangshuaiisme/article/details/80718496 

#### 2019年7月5日 -  2019年7月8日
1、询问老师关于扩展32位和int的区别：由于目前计算机大部分是64位的，不同编译器可能会将int编译不同的位数，因此采用统一的int32—t确保是32位；  
2、默认寄存器是无符号的；  
3、着手开始写代码，但是进度较慢。   

###### 目前进度：
1、将软件部分c++大框搭建完成，针对每条指令将立即数和操作码分割；     
2、按照英文版PDF指令顺序，完成并测试前四条指令：U类（LUI、ALUPC)、J类(JAL、JALR)；     
3、一些小tips：手动模拟计算机指令时，务必弄清楚指令跳转的地址，尽量找到易测试的地址，另外要注意符号扩展位；      
4、J类指令要注意立即数* 2，或者将立即数左移1位（老师代码实现的方法）；   
5、注意进制转换，最初我考虑PC用10进制输出，IR用16进制输出，但结果却都是16进制；    
  网上找到方法是在输出cout<<oct<<xxx;cout<<dec<<xxx;cout<<hex<<endl；  
  最终避免麻烦，我就都用16进制输出；  
6、立即数拼接主要用移位，然后和1相与则保持不变，和0或则保持不变；    

#### 2019年7月9日-2019年7月10日  
1、彻底把CPU模拟器软件c++版本编写完成,也算是把自己小学期任务完结。
2、打算明天让同伴帮忙再检查一遍，对于SRL指令有疑惑。  

###### 参考网站：
1、操作码中用很多需要进行有符号或者无符号比较的指令，需要分清楚c++默认大于小于号分别针对哪一类；   
https://www.cnblogs.com/zhaojk2010/p/5984457.html   

###### 整体感受： 
1、最初看2018版代码时，并不理解其中每个指令的含义，本打算在老师的代码上更改变成自己的，但是发现老师立即数命名很特别，而且看了一周都无法下手。最后决定自己写，于是和同伴针对每条老师的模拟测试指令进行分析，并用word截图记录结果，记录下问题和疑惑点。这样效率虽然不高，但是也便于理解，就这样一周过去了，第二周准备着手时，询问老师代码中关于立即数命名格式的意义，突然恍然大悟，所有迷点都解开了，这样写代码也比较顺畅了。  
2、对于写整个模拟器的顺序：（个人拙见）：  
1） 首先，应该耐心的看老师的代码，不应该是盲看，对于每条测试指令要按照指令格式自己走一遍，分析结果是否正确（PS：有一些是存在错误的），遇到结果可能错误的要和别人对照一下；  
2） 其次，自己动手前先观察指令表分为几类（ps：应该分为R/I/S/B/U/J 6类），并且由于代码量比较大，因此对于命名格式应该注意，便于日后自己能及时想起来；  
3） 然后，写代码时注意分块进行，切忌先把所有操作码都一次性定义完，因为代码不可能一天写完，之后每天写的时候会忘记之前定义的名称。建议：按照6类进行写代码，每写一类代码及时测试正确与否，注意测试时选取PC地址也需要巧妙，有些跳转指令，自己要预先估计跳转到哪里，也方便测试。  
4） 最后，写代码可以先写大框再填具体指令！！一定要边写代码边写注释！！！注释越多，事后检错，或者给别人看就更容易  
    
呼————终于大功告成之后长舒一口气，





  

